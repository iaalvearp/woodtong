---
import AsistenteVirtual from "../components/AsistenteVirtual.astro";
import IconoAcceso from "../components/IconoAcceso.tsx";

interface Props {
	titulo: string;
	descripcion?: string;
}

const {
	titulo,
	descripcion = "Woodtong - Redefiniendo el lujo y el diseño minimalista para tu hogar.",
} = Astro.props;

// Detección de sesión desde el middleware
const usuario = Astro.locals.usuario;
const usuarioActivo = !!usuario;
// Ensure rolUsuario is always a string to prevent serialization issues in production
const rolUsuario = usuario?.rol ?? "";
---

<!doctype html>
<html lang="es">
	<head>
		<!-- Meta-etiqueta CSP para habilitar Trusted Types en navegadores Chromium (Chrome/Edge) -->
		<!-- Esta política de seguridad es requerida para scripts de terceros como Dialogflow -->
		<!-- Permitimos todas las políticas que Dialogflow necesita internamente -->
		<meta
			http-equiv="Content-Security-Policy"
			content="trusted-types default goog#html lit-html highlight.js dialogflow#messenger; require-trusted-types-for 'script';"
		/>

		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/png" href="/favicon.png" />
		<meta name="generator" content={Astro.generator} />

		<!-- SEO -->
		<title>{titulo} | Woodtong</title>
		<meta name="description" content={descripcion} />
		<meta property="og:title" content={titulo} />
		<meta property="og:description" content={descripcion} />
		<meta property="og:type" content="website" />

		<!-- Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
			rel="stylesheet"
		/>

		<style is:global>
			:root {
				--primario: #064c39;
				--blanco: #ffffff;
				--oscuro: #0d0d0d;
				--gris-apple: #f5f5f7;
				--texto-apple: #1d1d1f;
				--texto-primario: #e0ebe0;
				--texto-primario-50: #f2f7f3;
				--texto-primario-200: #c4d6c7;
				--hover-primario: #a8c2ad;
				--cristal-primario: rgba(6, 76, 57, 0.8);
				--texto-secundario: #86868b;
				--sombra-suave: rgba(6, 76, 57, 0.08);
				--transicion-base: 0.6s cubic-bezier(0.16, 1, 0.3, 1);
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family:
					"Inter",
					-apple-system,
					BlinkMacSystemFont,
					"Segoe UI",
					Roboto,
					Oxygen,
					Ubuntu,
					Cantarell,
					"Open Sans",
					"Helvetica Neue",
					sans-serif;
				background-color: var(--blanco);
				color: var(--texto-apple);
				-webkit-font-smoothing: antialiased;
				-moz-osx-font-smoothing: grayscale;
				overflow-x: hidden;
				line-height: 1.5;
			}

			.body-admin {
				min-height: calc(100dvh - 128px);
				background: linear-gradient(
					180deg,
					var(--primario) 30%,
					var(--texto-primario-200) 100%
				);
			}

			.body-public {
				background: linear-gradient(
					180deg,
					var(--primario) 40%,
					var(--texto-primario-200) 100%
				);
			}

			h1,
			h2,
			h3,
			h4,
			h5,
			h6 {
				letter-spacing: -0.02em;
				line-height: 1.1;
			}

			/* Animaciones Globales */
			.revelar-arriba {
				opacity: 0;
				transform: translateY(30px);
				transition:
					opacity var(--transicion-base),
					transform var(--transicion-base);
			}

			.revelar-derecha {
				opacity: 0;
				transform: translateX(30px);
				transition:
					opacity var(--transicion-base),
					transform var(--transicion-base);
			}

			.visible {
				opacity: 1;
				transform: translate(0, 0) !important;
			}

			.no-scrollbar::-webkit-scrollbar {
				display: none;
			}
			.no-scrollbar {
				-ms-overflow-style: none;
				scrollbar-width: none;
			}
			#messageList .message.user-message span {
				color: var(--texto-primario-50) !important;
			}
		</style>

		<!-- Script de Política de Trusted Types -->
		<!-- IMPORTANTE: Este script debe ejecutarse ANTES que cualquier otro JavaScript -->
		<script is:inline>
			/**
			 * Política de Trusted Types para navegadores basados en Chromium
			 *
			 * ¿Qué es Trusted Types?
			 * Es una medida de seguridad en navegadores Chrome/Edge que previene
			 * ataques XSS (Cross-Site Scripting) al requerir que todo código
			 * JavaScript dinámico pase por una política de confianza.
			 *
			 * ¿Por qué lo necesitamos?
			 * Scripts de terceros como Dialogflow Messenger requieren crear
			 * URLs de scripts dinámicamente. Sin esta política, el navegador
			 * bloquearía estas operaciones con el error "createScriptURL".
			 *
			 * Políticas permitidas:
			 * - default: Nuestra política base para scripts generales
			 * - goog#html: Política interna de Google para manipulación de HTML
			 * - lit-html: Política de la librería Lit (usada por Dialogflow)
			 * - highlight.js: Política para resaltado de sintaxis en el chat
			 * - dialogflow#messenger: Política específica de Dialogflow ES (Essentials)
			 *
			 * Seguridad:
			 * - Solo creamos una política si no existe (guarda contra duplicados)
			 * - La política "default" permite pasar strings sin modificación
			 * - Dialogflow creará sus propias políticas (goog#html, lit-html, highlight.js, dialogflow#messenger)
			 * - Esto es seguro porque confiamos en los scripts de Google
			 */
			if (window.trustedTypes && window.trustedTypes.createPolicy) {
				// Verificar que no exista ya una política default
				// (evita errores si el script se ejecuta múltiples veces)
				if (!window.trustedTypes.defaultPolicy) {
					try {
						window.trustedTypes.createPolicy("default", {
							// Permite crear HTML dinámico
							createHTML: (s) => s,
							// Permite crear URLs de scripts (necesario para Dialogflow)
							createScriptURL: (s) => s,
							// Permite crear scripts inline
							createScript: (s) => s,
						});
						console.log(
							"✅ Política de Trusted Types configurada correctamente",
						);
					} catch (error) {
						console.warn(
							"⚠️ No se pudo crear la política de Trusted Types:",
							error,
						);
					}
				}
			}
		</script>
	</head>
	<body
		class={Astro.locals.usuario?.rol === "admin"
			? "body-admin"
			: "body-public"}
	>
		<header id="header-principal">
			<nav class="nav-container">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="216"
					height="120"
					fill="none"
					viewBox="0 0 216 120"
					class="logo"
				>
					<path
						fill="currentColor"
						d="M17.332 23.378c-1.018.01-1.595-.525-1.605-1.512-.01-1.552 1.101-2.961 2.336-2.961 1.039.01 1.965.915 1.986 1.953.03 1.204-1.369 2.51-2.717 2.52m1.626-2.87-.648-.493c-.124-.082-.556.113-.67.216-.41.401-1.13 1.193-1.07 1.584.063.4.577.678.762.678.515 0 1.235-.802 1.636-1.244.144-.154.278-.524-.01-.74M125.78 13.99c2.624-.422 4.949-1.913 6.595-3.99h-1.595c-1.584 1.625-3.714 2.684-6.008 2.828-2.449.154-4.949-.998-6.565-2.828h-1.595c2.007 2.797 5.711 4.555 9.168 3.99m76.921 44.442c-3.2-2.56-5.381-5.892-7.264-9.44-2.058-3.866-4.435-7.517-7.429-10.745-4.434-4.782-9.661-8.556-15.063-12.113-3.745-2.458-7.542-4.833-11.184-7.435-3.108-2.22-5.598-4.997-6.472-8.699h-1.194c.072.278.144.555.227.833 1.296 4.062 3.961 7.085 7.418 9.419 4.198 2.838 8.509 5.49 12.707 8.308 5.731 3.836 11.174 8.062 15.259 13.676 2.284 3.126 4.167 6.55 6.122 9.913 2.953 5.059 6.976 8.658 12.162 10.755v-1.367c-1.852-.782-3.632-1.79-5.289-3.105m-62.99 22.365c.36-.124.721-.247 1.081-.391 3.632-1.43 6.245-3.867 7.14-7.764.371-1.593.505-3.27.484-4.905-.041-2.58-.545-5.11-1.904-7.372-1.43-2.386-3.498-3.342-6.235-2.9-1.79.288-3.251 1.224-4.311 2.643-1.245 1.676-2.284 3.496-3.508 5.192-.988 1.378-2.12 2.653-3.19 3.98l-.432-.247c.041-.72.051-1.45.144-2.17.432-3.362 1.831-6.406 3.251-9.419 1.873-3.979 3.252-8.092 3.581-12.514.442-5.902-.463-11.568-3.221-16.853-1.389-2.663-3.683-3.897-6.657-3.445-2.202.33-4.383.905-6.533 1.481-8.201 2.2-16.628-5.213-15.496-13.316.144-.926.268-1.861.401-2.797h-1.255c-.113.689-.216 1.368-.319 2.057-1.276 8.76 6.524 16.709 15.259 15.496 1.739-.237 3.426-.792 5.134-1.193.854-.196 1.708-.453 2.583-.555 3.272-.38 5.268.904 6.688 4.462 2.623 6.612 3.22 13.43 1.152 20.267-1.06 3.486-2.685 6.808-4.064 10.2-1.111 2.736-1.934 5.543-1.821 8.535.072 1.697.452 1.903 1.883 1.029 1.913-1.172 3.056-3.013 4.239-4.843 1.008-1.574 1.955-3.23 3.21-4.586 3.395-3.671 7.429-2.849 9.312 1.779.164.4.308.822.422 1.244.637 2.447.679 4.925.277 7.413-.607 3.661-2.603 6.314-6.039 7.661-1.955.771-4.075 1.501-6.143 1.584"
					></path>
					<path
						fill="currentColor"
						d="M24.298 14.596c-1.821-.226-3.622-.617-5.432-.863-3.735-.514-7.049.267-9.024 3.763-.864 1.522-1.39 3.311-1.718 5.039-.515 2.683.627 4.71 3.076 5.974 7.5 3.866 14.827 3.424 21.998-.874 2.768-1.656 4.713-4.175 6.596-6.715 2.243-3.033 5.185-4.997 8.91-5.573a53 53 0 0 1 7.552-.596c5.217-.031 10.258 1.172 15.31 2.303 3.252.73 6.503 1.152 9.796.154 3.9-1.182 6.163-4.01 6.4-7.208H86.65c-.195 1.985-1.358 3.805-3.436 4.977-1.369.771-2.974 1.265-4.538 1.522-2.88.462-5.69-.309-8.468-.998C63.5 13.836 56.74 12.9 49.815 13.866c-4.373.617-8.015 2.417-10.742 5.995-1.348 1.769-2.788 3.517-4.424 5.028-6.174 5.697-16.082 6.664-23.15 2.396-1.43-.863-2.367-1.995-2.285-3.722.093-2.046.628-3.98 1.79-5.697 1.132-1.655 2.655-2.848 4.682-2.92 1.739-.062 3.498.185 5.237.36 1.276.134 2.531.422 3.807.545 5.134.483 7.727-2.52 8.602-5.851h-1.235c-1.05 3.332-3.9 5.08-7.799 4.596"
					></path>
					<path
						fill="currentColor"
						d="M81.413 73.938c-.587-9.79 2.665-17.892 10.145-24.319a54 54 0 0 0 5.37-5.357c2.13-2.416 3.54-5.213 3.602-8.535v-.329c-.123-5.676-4.383-9.007-9.867-7.609-1.76.452-3.468 1.183-5.145 1.923-3.529 1.563-7.1 1.79-10.721.504-2.757-.987-5.505-2.026-8.19-3.208-7.028-3.116-13.911-2.838-20.66.75-2.563 1.358-5.053 2.849-7.532 4.34-3.457 2.077-6.853 4.308-10.752 5.49-7.018 2.12-13.747 2.284-19.663-2.25v1.542c5.278 3.517 11.081 3.887 17.1 2.643 4.785-.987 8.91-3.486 13.088-5.882 3.622-2.088 7.244-4.206 11.03-5.943 4.877-2.252 9.96-2.263 14.992-.278a290 290 0 0 1 7.644 3.116c4.95 2.107 9.857 2.282 14.817.01 1.553-.72 3.2-1.296 4.866-1.717 3.118-.782 5.804.617 7.11 3.547 1.132 2.53.782 5.018-.298 7.455-1.163 2.643-3.097 4.7-5.135 6.674-2.397 2.324-4.97 4.503-7.068 7.074-5.052 6.19-6.359 13.501-5.896 21.316.113 1.964.196 3.949.185 5.923h1.184a96 96 0 0 0-.206-6.88m25.558 2.098c.761-.309 1.523-.761 2.089-1.337.638-.648.638-1.563.154-2.355-.515-.843-1.286-.514-1.976-.278a17.06 17.06 0 0 1-8.375.659c-2.192-.37-4.321-1.1-6.492-1.635-1.822-.453-3.241.205-4.29 1.706-1.195 1.687-1.267 3.61-1.205 5.584.02.802.062 1.614.093 2.416h1.327c-.03-.71-.072-1.429-.144-2.159-.154-1.378.041-2.88.422-4.216.545-1.933 2.171-2.601 4.095-1.995.35.113.7.237 1.04.36 3.672 1.316 7.428 1.656 11.276 1.06 1.101-.175 2.202-.422 3.457-.669-.329 1.08-1.142 1.398-1.893 1.686-1.842.71-3.745 1.286-5.577 2.026-2.315.936-4.177 2.242-5.587 3.897h1.688a13.3 13.3 0 0 1 3.426-2.324c2.068-.966 4.332-1.563 6.472-2.426m77.91-8.566c-.998-3.938-1.997-7.887-2.881-11.856-2.398-10.828-8.242-19.208-17.636-25.151a165 165 0 0 1-9.373-6.365c-4.816-3.527-7.398-8.237-7.347-14.098h-1.09c-.011.226-.011.452-.021.679-.123 5.336 2.192 9.8 6.287 13.161 2.747 2.252 5.72 4.227 8.715 6.14 4.506 2.889 8.704 6.097 12.1 10.292 4.002 4.946 6.06 10.725 7.49 16.823.998 4.277 2.068 8.545 3.354 12.75 1.214 3.97 3.992 6.664 7.779 8.36a41 41 0 0 0 7.696 2.581H208c-4.476-.267-8.972-1.234-13.499-2.89-5.073-1.85-8.303-5.223-9.62-10.426m-23.244-8.041c-1.111-.7-2.15-1.532-3.148-2.396-2.603-2.272-3.622-5.409-4.239-8.627-1.142-6.005-4.044-10.9-8.561-14.992-2.274-2.057-4.362-4.37-6.286-6.756-2.13-2.643-3.077-5.81-2.377-9.193a53 53 0 0 1 2.109-7.444h-1.327c-.175.442-.34.874-.525 1.305-.319.74-.514 1.532-.761 2.294-1.894 5.758-.896 10.94 3.189 15.444 1.605 1.769 3.303 3.435 5.001 5.11 2.541 2.51 5.144 4.988 6.472 8.391.812 2.067 1.348 4.257 1.913 6.417.731 2.745 1.441 5.522 3.416 7.65a26 26 0 0 0 4.301 3.733c4.857 3.321 9.394 6.971 12.738 11.866 1.904 2.787 3.622 5.686 5.33 8.596h1.44c-.689-1.172-1.409-2.334-2.068-3.527-4.043-7.362-9.486-13.398-16.617-17.871"
					></path>
					<path
						fill="currentColor"
						d="M73.51 63.367c-.514-2.478-2.397-3.136-4.259-1.43-.854.782-1.512 1.79-2.233 2.705-4.753 6.036-10.958 9.543-18.623 9.995-9.291.545-16.782-3.116-22.44-10.499-1.492-1.953-2.923-3.969-4.559-5.789-3.817-4.267-8.55-5.295-13.375-3.115v1.244c4.218-2.293 8.58-1.44 12.274 2.468 1.729 1.83 3.18 3.928 4.692 5.964 8.92 11.969 25.445 14.54 37.525 5.84 2.747-1.974 4.928-4.473 6.863-7.239.411-.596 1.347-1.08 2.057-1.1.35-.01.751 1.152 1.08 1.81.114.216.114.504.145.75.319 3.692.01 7.322-1.204 10.849a40 40 0 0 1-2.12 4.987h1.348q.494-1.018.957-2.067c2.089-4.925 2.984-10.036 1.873-15.373"
					></path>
					<path
						fill="currentColor"
						d="M77.493 58.781c-.237-1.923-1.08-2.684-2.963-2.324a170 170 0 0 0-10.403 2.283c-3.436.874-6.78 2.19-10.237 2.9-4.682.956-9.436.534-14.158.01-7.697-.843-14.395-3.404-18.572-10.52-1.79-3.053-4.682-4.05-8.129-3.64-1.677.206-3.354.392-5.031.607v1.152a68 68 0 0 0 4.075-.483c3.817-.576 6.821.37 8.807 4 2.027 3.712 5.299 6.118 9.137 7.773 4.105 1.78 8.468 2.273 12.882 2.571 6.204.412 12.305.154 18.222-2.087 4.331-1.646 8.776-2.88 13.417-3.342 1.193-.123 1.646.154 1.81 1.337.155 1.09.35 2.21.227 3.29-.432 3.928-.864 7.866-1.533 11.764a82 82 0 0 1-1.45 6.735h1.254c1.544-5.851 2.398-11.836 3.056-17.81-.144-1.522-.236-2.88-.411-4.216m95.133-38.447c1.944.761 3.889 1.522 5.813 2.334 4.63 1.964 9.116 4.227 12.398 8.144 2.233 2.663 4.157 5.584 6.112 8.463 2.531 3.722 5.433 7.044 9.528 9.1.504.247 1.008.483 1.512.72v-1.347l-.401-.185c-3.334-1.553-6.05-3.867-8.149-6.88-1.09-1.562-2.191-3.125-3.159-4.77-3.745-6.376-9.136-10.838-15.886-13.707-2.634-1.121-5.289-2.18-7.933-3.26-4.568-1.84-7.758-4.905-9.816-8.946h-1.358c2.243 4.689 5.947 8.216 11.339 10.334"
					></path>
					<path
						fill="currentColor"
						d="M88.039 46.884c1.842-1.08 3.148-2.643 3.797-4.679 1.018-3.228-1.07-5.655-4.404-5.069-1.544.267-3.107.617-4.579 1.141-4.136 1.46-8.149 1.173-12.1-.627-.905-.411-1.81-.792-2.716-1.213-3.015-1.388-6.081-2.56-9.456-2.735-6.863-.36-12.995 1.871-18.747 5.367-2.047 1.244-3.94 2.694-5.34 4.69-1.841 2.632-2.654 5.47-1.512 8.616.144.411.658.823 1.09.967 1.986.658 4.034 1.13 5.989 1.83 4.527 1.625 9.136 2.735 13.602 2.591 5.999 0 10.227-.822 15.763-3.218 5.515-2.386 10.876-5.131 16.7-6.766.689-.196 1.316-.545 1.913-.895M71 52.55c-5.37 2.54-10.978 4.113-16.946 4.051-4.785.062-9.322-1.038-13.777-2.642-1.76-.628-3.56-1.142-5.36-1.615-.639-.164-.906-.473-1.06-1.07-.649-2.529.164-4.698 1.594-6.724 1.626-2.314 3.9-3.856 6.328-5.193 5.042-2.776 10.34-4.7 16.216-4.514 3.025.093 5.823 1.028 8.56 2.242 1.976.874 3.962 1.748 5.988 2.488 3.324 1.213 6.688 1.07 10.053.03 1.502-.462 3.035-.883 4.568-1.182 1.05-.205 2.254-.493 3.067.566.812 1.06.823 2.386.216 3.445-.67 1.172-1.626 2.231-2.655 3.115-.751.648-1.77 1.07-2.747 1.337C80.147 48.252 75.568 50.38 71 52.55m86.388 22.365c-.504.03-1.101.627-1.42 1.13-.298.453-.453 1.132-.391 1.677.113 1.028.216 2.077.442 3.075h1.441c-.227-.761-.453-1.522-.69-2.283-.246-.802-.185-1.676.752-2.396.288.4.607.74.802 1.141.556 1.172 1.122 2.355 1.667 3.527h1.307c-.772-1.655-1.554-3.3-2.387-4.925-.258-.463-1.029-.977-1.523-.946m-28.686-38.159c-1.286-2.057-3.025-3.425-5.587-3.25-1.863.124-3.766.175-5.546.669-2.675.73-5.34 1.604-7.84 2.786-4.188 2.005-6.4 5.8-8.047 9.933-1.646 4.154-4.012 7.692-7.768 10.273-1.08.74-1.996 1.871-2.654 3.023-1.678 2.94-.597 6.005 2.572 7.177 1.893.7 3.426.75 5.402 1.234.257.01.494.01.864-.041.844-.072 1.451-.01 2.253-.216 4.888-1.275 9.806-2.457 14.621-3.98 1.78-.565 3.54-1.737 4.877-3.064 4.486-4.421 7.089-9.912 8.293-16.061.576-2.982.206-5.861-1.44-8.483m.236 8.39c-1.07 5.306-3.395 10.057-6.832 14.231-1.522 1.851-3.457 3.219-5.72 3.99-4.929 1.687-9.919 3.178-15.095 3.908-.504.072-.586.051-1.1.133-.31.052-.577.062-.865-.01-1.872-.463-3.447-.524-5.247-1.193-2.336-.874-3.087-2.879-1.914-5.09.617-1.162 1.523-2.324 2.593-3.054 3.827-2.611 6.266-6.21 7.943-10.426a32 32 0 0 1 1.801-3.764c1.718-3.095 4.229-5.337 7.49-6.694 3.643-1.522 7.377-2.622 11.411-2.457 1.677.072 2.85.833 3.807 2.077 1.924 2.498 2.325 5.378 1.728 8.35M67.389 11.779c1.584.236 3.128-.154 4.115-1.563l.124-.216h-1.45c-.917.854-2.223.7-3.396.411A73 73 0 0 1 65.135 10h-4.198l1.883.617c1.482.504 3.015.936 4.569 1.162m139.459 15.486c.37.02.761-.309 1.152-.473-.339-.237-.648-.617-1.019-.69-.895-.184-1.821-.184-2.726-.328-4.63-.71-8.622-2.581-11.524-6.407-2.13-2.817-3.437-6.015-4.414-9.367h-1.173c.34 1.141.689 2.283 1.07 3.414 3.005 8.843 9.353 13.378 18.634 13.85M208 15.501v-1.429A25.6 25.6 0 0 1 202.927 10h-1.625c1.862 2.108 4.095 3.938 6.698 5.501"
					></path>
					<path
						fill="currentColor"
						d="M67.306 40.56c-3.344-.946-6.667-2.056-10.083-2.57-4.795-.72-9.353.236-13.232 3.424-2.407 1.974-4.126 4.37-4.218 7.63-.062 2.18.679 2.9 2.87 2.9 2.675.01 5.35 0 8.026 0v-.145c1.317 0 2.644.02 3.961 0 3.467-.051 6.873-.473 10.114-1.779 1.945-.791 3.817-1.748 5.176-3.424 1.276-1.563 1.142-3.372-.381-4.689-.648-.565-1.42-1.11-2.233-1.347m1.101 5.902c-2.623 2.263-5.762 3.373-9.126 3.733-3.272.35-6.575.422-9.034.566-3.046 0-5.248-.02-7.45.01-1.502.02-1.923-.36-1.851-1.861a7.17 7.17 0 0 1 1.553-4.154c3.612-4.617 8.478-6.16 14.137-5.666 3.684.319 7.162 1.48 10.598 2.797.268.102.535.246.782.39 1.904 1.162 2.079 2.725.391 4.185m55.099-6.961c-1.4-.36-2.891-.37-4.342-.545-4.599-.421-7.933 1.368-9.95 5.542-1.193 2.468-2.397 4.947-3.58 7.425-.474.987-1.009 1.964-1.328 3.012-.771 2.53.432 4.34 3.036 4.782 2.222.38 4.393.051 6.533-.473 7.336-1.79 12.584-7.846 12.985-14.961.154-2.664-.782-4.124-3.354-4.782m2.16 5.357c-.946 6.664-5.679 11.795-12.398 13.255-1.739.38-3.56.504-5.34.463-2.243-.052-3.22-1.574-2.294-3.6 1.677-3.701 3.426-7.382 5.329-10.971 1.688-3.188 4.6-4.123 8.046-3.784 1.204.103 2.429.093 3.612.319 2.48.452 3.395 1.82 3.045 4.318"
					></path>
					<path
						fill="currentColor"
						d="M118.258 41.63c-.524-.165-1.265-.052-1.749.215-2.757 1.492-4.198 3.898-4.486 6.983-.154 1.696.576 2.735 2.223 3.166 1.018.268 2.078.37 3.127.556 2.552.092 3.653-.658 4.384-3.075.185-.627.319-1.275.473-1.912.741-2.962-.36-4.813-3.972-5.933m2.192 7.897c-.443 1.419-1.152 1.84-2.655 1.86-1.08-.174-2.171-.318-3.251-.544-.906-.185-1.369-.771-1.307-1.738q.247-4.103 3.797-6.17c.185-.102.401-.195.617-.205 1.77-.082 3.725 1.954 3.488 3.691a20 20 0 0 1-.689 3.106M37.9 85.432l-6.09 23.418h-2.562l-6.42-21.175-6.205 21.175H14.05L8 85.432h1.821l5.515 21.175 6.205-21.175h2.561l6.42 21.175 5.567-21.175zM51.554 85c1.595 0 3.076.288 4.424.854a9.9 9.9 0 0 1 3.499 2.439c.977 1.06 1.739 2.325 2.284 3.807s.823 3.138.823 4.959c0 1.81-.268 3.467-.813 4.959-.535 1.502-1.296 2.789-2.274 3.869a10.1 10.1 0 0 1-3.488 2.5c-1.348.587-2.84.885-4.465.885s-3.118-.298-4.466-.885a10.2 10.2 0 0 1-3.498-2.49c-.978-1.07-1.739-2.356-2.274-3.848-.545-1.502-.813-3.159-.813-4.98 0-1.842.278-3.498.823-4.98.546-1.481 1.317-2.747 2.305-3.796a10.1 10.1 0 0 1 3.498-2.429c1.338-.576 2.82-.864 4.435-.864m-.02 22.564c1.337 0 2.582-.226 3.714-.7a8.2 8.2 0 0 0 2.943-2.037c.823-.895 1.47-1.996 1.923-3.303s.69-2.788.69-4.455c0-1.687-.237-3.169-.7-4.445-.463-1.286-1.1-2.366-1.924-3.24a8 8 0 0 0-2.912-1.987c-1.121-.442-2.346-.668-3.673-.668-1.358 0-2.603.226-3.735.689a8.4 8.4 0 0 0-2.943 1.996q-1.236 1.312-1.934 3.241c-.463 1.286-.7 2.758-.7 4.424s.227 3.159.69 4.456q.679 1.96 1.914 3.302a8 8 0 0 0 2.932 2.038c1.132.463 2.366.689 3.714.689M77.43 85c1.596 0 3.077.288 4.425.854a9.9 9.9 0 0 1 3.499 2.439c.977 1.06 1.738 2.325 2.284 3.807s.823 3.138.823 4.959c0 1.81-.268 3.467-.813 4.959s-1.296 2.789-2.274 3.859a10.1 10.1 0 0 1-3.488 2.5c-1.348.586-2.84.885-4.465.885s-3.118-.299-4.466-.885a10.1 10.1 0 0 1-3.498-2.49c-.978-1.07-1.739-2.356-2.274-3.848-.545-1.502-.813-3.159-.813-4.98 0-1.842.278-3.498.823-4.98q.821-2.222 2.305-3.797a10.1 10.1 0 0 1 3.498-2.428c1.348-.566 2.83-.854 4.435-.854m-.02 22.564c1.338 0 2.583-.226 3.715-.7a8.2 8.2 0 0 0 2.942-2.037c.824-.895 1.472-1.996 1.925-3.303.452-1.306.689-2.788.689-4.455 0-1.687-.237-3.169-.7-4.445s-1.1-2.366-1.924-3.24a8 8 0 0 0-2.912-1.987c-1.121-.442-2.346-.668-3.673-.668-1.358 0-2.603.226-3.735.689a8.3 8.3 0 0 0-2.943 1.996c-.833.875-1.47 1.955-1.934 3.241s-.7 2.758-.7 4.424.227 3.159.69 4.456q.679 1.96 1.914 3.302a8 8 0 0 0 2.932 2.038c1.142.463 2.377.689 3.714.689m34.89-10.608c0 7.933-3.941 11.894-11.832 11.894h-7.08V85.453h7.08c3.951 0 6.904.956 8.879 2.85 1.965 1.903 2.953 4.794 2.953 8.653m-1.821 0c0-1.544-.154-2.912-.463-4.126s-.844-2.243-1.616-3.087c-.771-.843-1.8-1.492-3.086-1.934-1.286-.443-2.922-.659-4.888-.659h-5.33v20.002h5.33c1.955 0 3.571-.226 4.867-.689 1.286-.453 2.326-1.121 3.087-1.996.772-.875 1.307-1.945 1.626-3.2.319-1.266.473-2.696.473-4.311m23.037-9.816h-8.19v21.71h-1.708V87.14h-8.108v-1.708h18.006zM147.634 85c1.594 0 3.076.288 4.424.854a9.9 9.9 0 0 1 3.498 2.439c.978 1.06 1.739 2.325 2.284 3.807.546 1.481.823 3.138.823 4.959 0 1.81-.267 3.467-.812 4.959-.546 1.502-1.297 2.789-2.274 3.859a10.1 10.1 0 0 1-3.488 2.5c-1.348.586-2.84.885-4.466.885-1.625 0-3.117-.299-4.465-.885a10.2 10.2 0 0 1-3.499-2.49c-.977-1.07-1.738-2.356-2.273-3.848-.546-1.502-.813-3.159-.813-4.98 0-1.842.278-3.498.823-4.98s1.317-2.747 2.305-3.797a10.1 10.1 0 0 1 3.498-2.428c1.348-.566 2.829-.854 4.435-.854m-.021 22.564c1.338 0 2.583-.226 3.714-.7a8.2 8.2 0 0 0 2.943-2.037c.823-.895 1.471-1.996 1.924-3.303s.689-2.788.689-4.455c0-1.687-.236-3.169-.699-4.445s-1.101-2.366-1.924-3.24a8 8 0 0 0-2.912-1.987c-1.122-.452-2.346-.668-3.673-.668-1.358 0-2.603.226-3.735.689a8.25 8.25 0 0 0-2.943 1.996c-.823.875-1.471 1.955-1.934 3.241s-.7 2.758-.7 4.424.226 3.159.689 4.456q.68 1.96 1.914 3.302a8 8 0 0 0 2.933 2.038c1.142.463 2.376.689 3.714.689m34.057 1.286h-2.243l-14.291-21.39v21.39h-1.708V85.432h2.356l14.178 21.35v-21.35h1.708zm15.979.422c-1.667 0-3.189-.288-4.568-.875a10.25 10.25 0 0 1-3.54-2.469c-.987-1.06-1.739-2.346-2.274-3.848s-.802-3.18-.802-5.01c0-1.853.267-3.52.813-5.001s1.296-2.748 2.274-3.797a9.9 9.9 0 0 1 3.498-2.418c1.358-.566 2.85-.844 4.496-.844 1.286 0 2.48.165 3.591.484s2.109.782 2.974 1.368a8 8 0 0 1 2.16 2.13c.577.834.968 1.75 1.173 2.758h-1.841c-.114-.69-.391-1.328-.824-1.935a6.2 6.2 0 0 0-1.697-1.594 9.1 9.1 0 0 0-2.439-1.091q-1.388-.401-3.056-.401c-1.368 0-2.623.226-3.765.658a7.9 7.9 0 0 0-2.943 1.976c-.823.874-1.461 1.965-1.914 3.25-.453 1.287-.689 2.779-.689 4.456 0 1.667.226 3.159.689 4.455q.68 1.96 1.914 3.303a7.9 7.9 0 0 0 2.953 2.037c1.152.463 2.418.7 3.797.7 1.934 0 3.621-.37 5.052-1.111a10.5 10.5 0 0 0 3.611-3.077v-4.218h-6.462V97.45H208v11.4h-.988l-.751-3.128a8.8 8.8 0 0 1-1.8 1.657 9.6 9.6 0 0 1-2.089 1.09c-.731.278-1.502.484-2.295.608-.792.133-1.605.195-2.428.195"
					></path>
				</svg>

				<!-- Escritorio -->
				<div class="enlaces-escritorio">
					<a href="/">Inicio</a>
					<a href="/tienda">Tienda</a>
					<a href="/nosotros">Conócenos</a>
					<a href="/admin">Panel</a>
				</div>

				<div class="acciones">
					<IconoAcceso
						client:load
						usuarioActivo={usuarioActivo}
						rolUsuario={rolUsuario}
					/>
					<button class="menu-hamburguesa" id="btn-menu">
						<span class="material-symbols-outlined">menu</span>
					</button>
				</div>
			</nav>

			<!-- Mobile Menu Overlay -->
			<div class="menu-movil" id="menu-movil">
				<div class="enlaces-movil">
					<a href="/">Inicio</a>
					<a href="/tienda">Tienda</a>
					<a href="/nosotros">Conócenos</a>
					<a href="/admin">Panel</a>
				</div>
			</div>
		</header>

		<main>
			<slot />
		</main>

		<AsistenteVirtual />

		<script>
			// Intersection Observer para animaciones
			const observerOptions = {
				threshold: 0.1,
				rootMargin: "0px 0px -50px 0px",
			};

			const observer = new IntersectionObserver((entries) => {
				entries.forEach((entry) => {
					if (entry.isIntersecting) {
						entry.target.classList.add("visible");
					}
				});
			}, observerOptions);

			document
				.querySelectorAll(".revelar-arriba, .revelar-derecha")
				.forEach((el) => observer.observe(el));

			// Lógica del Header
			const btnMenu = document.getElementById("btn-menu");
			const menuMovil = document.getElementById("menu-movil");
			const header = document.getElementById("header-principal");

			btnMenu?.addEventListener("click", () => {
				menuMovil?.classList.toggle("activo");
				btnMenu.querySelector(
					".material-symbols-outlined",
				)!.textContent = menuMovil?.classList.contains("activo")
					? "close"
					: "menu";
			});

			// Cambio de fondo al hacer scroll
			window.addEventListener("scroll", () => {
				if (window.scrollY > 50) {
					header?.classList.add("scrolled");
				} else {
					header?.classList.remove("scrolled");
				}
			});
		</script>

		<style>
			#header-principal {
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				z-index: 1000;
				height: 64px;
				transition:
					background-color 0.3s ease,
					backdrop-filter 0.3s ease;
				display: flex;
				align-items: center;
				padding: 0 1.5rem;
			}

			#header-principal.scrolled {
				background-color: var(--cristal-primario);
				backdrop-filter: blur(8px);
			}

			.nav-container {
				max-width: 1200px;
				margin: 0 auto;
				width: 100%;
				height: 100%;
				display: flex;
				justify-content: space-between;
				align-items: center;
				color: var(--texto-primario);
			}

			.logo {
				height: 100%;
				width: auto;
				padding: 0.5rem 0;
				color: var(--texto-primario-50);
			}

			.enlaces-escritorio {
				display: none;
				gap: 2rem;
			}

			.enlaces-escritorio a {
				text-decoration: none;
				color: var(--texto-primario-50);
				font-size: 0.875rem;
				font-weight: 500;
				transition: color 0.2s ease;
			}

			.enlaces-escritorio a:hover {
				color: var(--blanco);
			}

			.nombre-marca,
			.material-symbols-outlined {
				color: var(--texto-primario);
				cursor: pointer;
			}

			.nombre-marca:hover {
				color: var(--hover-primario);
			}

			.acciones {
				display: flex;
				align-items: center;
				gap: 1rem;
			}

			.btn-acceso,
			.menu-hamburguesa {
				background: none;
				border: none;
				cursor: pointer;
				color: var(--texto-primario);
				display: flex;
				align-items: center;
				justify-content: center;
				padding: 8px;
				border-radius: 50%;
				transition: background-color 0.2s ease;
				text-decoration: none;
			}

			.btn-acceso:hover,
			.menu-hamburguesa:hover {
				background-color: rgba(255, 255, 255, 0.1);
			}

			.menu-movil {
				position: fixed;
				top: 64px;
				left: 0;
				right: 0;
				bottom: 0;
				background: var(--blanco);
				z-index: 999;
				display: none;
				padding: 2rem;
			}

			.menu-movil.activo {
				display: block;
				animation: fadeIn 0.3s ease;
			}

			.enlaces-movil {
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
			}

			.enlaces-movil a {
				text-decoration: none;
				color: var(--texto-apple);
				font-size: 1.5rem;
				font-weight: 700;
				letter-spacing: -0.03em;
			}

			@keyframes fadeIn {
				from {
					opacity: 0;
					transform: translateY(-10px);
				}
				to {
					opacity: 1;
					transform: translateY(0);
				}
			}

			@media (min-width: 768px) {
				.enlaces-escritorio {
					display: flex;
				}
				.enlaces-escritorio a {
					color: var(--texto-primario);
				}
				.menu-hamburguesa {
					display: none;
				}
				.logo {
					padding: 0.25rem 0;
				}
			}
		</style>
	</body>
</html>
